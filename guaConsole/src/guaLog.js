"use strict";function _construct(e,t,n){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(e,t,n){var a=[null];a.push.apply(a,t);a=new(Function.bind.apply(e,a));return n&&_setPrototypeOf(a,n.prototype),a}).apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var _require=require("../utils"),e=_require.e,ensure=_require.ensure,log=_require.log,equals=_require.equals,isArray=_require.isArray,isObject=_require.isObject,es=_require.es,EventEmitter=require("events").EventEmitter;window.debug=!1;var GuaLog=function(){function t(){_classCallCheck(this,t),this.container=e("#id-div-log"),this.init()}return _createClass(t,[{key:"init",value:function(){this.insertStyle(),this.drawNavBar(),this.drawExpandButton("展开数组","array"),this.drawExpandButton("展开对象","object"),this.drawExpandButton("展开所有","all")}},{key:"templateStyle",value:function(e){return"\n    <style>\n        .number {\n            color: blue;\n        }\n        .string {\n            color: brown;\n        }\n        .hidden {\n            display: none;\n        }\n        .pointer {\n            cursor: pointer;\n        }\n        .pointer-img {\n            margin-right: 4px;\n            width: 8px;\n            bottom: 1px;\n            position: relative;\n        }\n        .bar {\n            display: inline-block;\n            width: 90px;\n            height: 30px;\n            text-align: center;\n            vertical-align: middle;\n            line-height: 32px;\n            color: #6b6666;\n        }\n        .bar-selected {\n            border-bottom: 2px solid #558ceff0;\n        }\n        .bar-unselected {\n            border-bottom: 2px solid #d3d3d34f;\n        }\n        .nav-bar {\n            background-color: #d3d3d34f;\n            border-bottom: 1px solid #b5b3b3e6;\n            margin-bottom: 5px;\n        }\n        .bar-hover {\n            background-color: #e2e1e1;\n        }\n        .expand-button {\n            cursor: pointer;\n            float: right;\n            border: 1px solid lightblue;\n            border-radius: 6px;\n            padding: 5px;\n            background-color: lightyellow;\n            margin: 3px;\n        }\n    </style>\n    "}},{key:"insertStyle",value:function(){var e=this.templateStyle();document.head.insertAdjacentHTML("beforeend",e)}},{key:"logChar",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"black",n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.container,a=document.createElement("span");a.innerHTML=e,a.setAttribute("style","color: ".concat(t)),n.appendChild(a)}},{key:"logNumber",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.container,n=document.createElement("span");n.innerHTML=e,n.setAttribute("class","number"),t.appendChild(n)}},{key:"logString",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.container,n=document.createElement("span");n.innerHTML='"'.concat(e,'"'),n.setAttribute("class","string"),t.appendChild(n)}},{key:"logNewLine",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.container,t=document.createElement("hr");e.appendChild(t)}},{key:"_logValue",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.container,n=2<arguments.length?arguments[2]:void 0,a=_typeof(e);"number"===a?this.logNumber(e,t,"span"):"string"===a?this.logString(e,t):isArray(e)?this.logArray(e,t,n):isObject(e)&&this.logObject(e,t,n)}},{key:"logValue",value:function(e){this._logValue(e),this.logNewLine()}},{key:"getImg",value:function(){var e=document.createElement("img");return e.src="http://localhost:63342/guaConsole/src/static/right.png",e}},{key:"setImgSrc",value:function(e,t){e.src="http://localhost:63342/guaConsole/src/static/".concat(t,".png")}},{key:"logExpandLine",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.container,a=3<arguments.length&&void 0!==arguments[3]&&arguments[3],r=document.createElement("div");a?this.logChar(e,"plum",r):this.logChar(e,"purple",r),this.logChar(": ","black",r),this._logValue(t,r,"span"),n.appendChild(r)}},{key:"logProtoLine",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.container,n=document.createElement("div");this.logChar("__proto__","plum",n),this.logChar(": ","black",n),isArray(e)?this.logChar("Array(0)","black",n):isObject(e)&&this.logChar("Object","black",n),t.appendChild(n)}},{key:"expandedArrayDiv",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.container,n=document.createElement("div");n.setAttribute("data-expand",!0),n.setAttribute("id","test");for(var a=t,r=1;"id-div-log"!==a.id&&"HTML"!==a.tagName;){if(a.dataset.hasOwnProperty("expand")&&(log("层级+1"),20<=(r+=1))){log("不展开了");break}if(!(a=a.parentElement))break}n.setAttribute("style","text-indent: ".concat(30*r,"px"));for(var i=0;i<e.length;i++){var o=e[i];this.logExpandLine(i,o,n)}return this.logExpandLine("length",e.length,n,!0),this.logProtoLine(e,n),n}},{key:"expandedObjectDiv",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.container,n=document.createElement("div");n.setAttribute("data-expand",!0),n.setAttribute("id","test");for(var a=t,r=1;"id-div-log"!==a.id&&"HTML"!==a.tagName;)a.dataset.hasOwnProperty("expand")&&(r+=1),a=a.parentNode;n.setAttribute("style","text-indent: ".concat(30*r,"px"));for(var i=Object.keys(e),o=0;o<i.length;o++){var l=i[o],s=e[l];this.logExpandLine(l,s,n)}return this.logProtoLine(e,n),n}},{key:"expandDom",value:function(e,t,n){for(var a,r=null,i=0;i<e.childNodes.length;i++){var o=e.childNodes[i];if(o.dataset.expand){r=o;break}}r?r.classList.contains("hidden")?(this.setImgSrc(n,"down"),r.classList.remove("hidden")):(this.setImgSrc(n,"right"),r.classList.add("hidden")):(a=this.expandedArrayDiv(t,e),isObject(t)&&(a=this.expandedObjectDiv(t,e)),e.appendChild(a))}},{key:"logArray",value:function(t){var n=this,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.container,a=(a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"div")||"div",r=document.createElement(a);r.setAttribute("id","expandable-dom");var i=this.getImg();i.classList.add("pointer"),i.classList.add("pointer-img"),i.addEventListener("click",function(e){n.setImgSrc(i,"down"),n.expandDom(r,t,i)});a=new EventEmitter;a.on("expandArray",function(){n.setImgSrc(i,"down"),n.expandDom(r,t,i)}),i.expandEvent=a,r.appendChild(i);var o=document.createElement("span");o.setAttribute("style","font-style: italic;"),this.logChar("(".concat(t.length,") "),"black",o),this.logChar("[","black",o);for(var l=0;l<t.length;l++){var s=t[l];isArray(s)?this.logChar("Array(".concat(s.length,")"),"black",o):isObject(s)?this.logChar("{...}","black",o):this._logValue(s,o),l!==t.length-1&&this.logChar(", ","black",o)}this.logChar("]","black",o),r.appendChild(o),e.appendChild(r),window.debug&&(this.setImgSrc(i,"down"),this.expandDom(r,t,i))}},{key:"logObject",value:function(){var t=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.container,a=(a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"div")||"div",r=document.createElement(a);r.setAttribute("id","expandable-dom");var i=this.getImg();i.classList.add("pointer"),i.classList.add("pointer-img"),i.addEventListener("click",function(e){t.setImgSrc(i,"down"),t.expandDom(r,n,i)});a=new EventEmitter;a.on("expandObject",function(){t.setImgSrc(i,"down"),t.expandDom(r,n,i)}),i.expandEvent=a,r.appendChild(i);var o=document.createElement("span");o.setAttribute("style","font-style: italic;"),this.logChar("{","black",o);for(var l=Object.keys(n),s=0;s<l.length;s++){var d=l[s],c=n[d];this.logChar(d,"block",o),this.logChar(": ","block",o),isArray(c)?this.logChar("Array(".concat(c.length,")"),"black",o):isObject(c)?this.logChar("{...}","black",o):this._logValue(c,o),s!==l.length-1&&this.logChar(", ","block",o)}this.logChar("}","black",o),r.appendChild(o),e.appendChild(r)}},{key:"navBarSpan",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=document.createElement("span");return n.classList.add("bar"),t?n.classList.add("bar-selected"):n.classList.add("bar-unselected"),n.innerHTML=e,n.addEventListener("mouseover",function(){for(var e=n.parentNode.childNodes,t=0;t<e.length;t++)e[t].classList.remove("bar-hover");n.classList.add("bar-hover")}),n}},{key:"drawNavBar",value:function(){var n=document.createElement("nav");n.classList.add("nav-bar"),n.addEventListener("mouseleave",function(){for(var e=n.childNodes,t=0;t<e.length;t++)e[t].classList.remove("bar-hover")}),n.appendChild(this.navBarSpan("Elements")),n.appendChild(this.navBarSpan("Network")),n.appendChild(this.navBarSpan("Console",!0)),n.appendChild(this.navBarSpan("Sources")),this.container.appendChild(n)}},{key:"autoExpand",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"all";if(e.dataset.hasOwnProperty("expand"))for(var n=0;n<e.children.length;n++){var a=e.children[n];this.autoExpand(a)}else for(var r=0;r<e.children.length;r++){var i,o=e.children[r];"expandable-dom"!==o.id||(i=o.querySelector("img")).expandEvent&&(["expandArray"].includes(Object.keys(i.expandEvent._events)[0])&&["all","array"].includes(t)&&(i.expandEvent.emit("expandArray"),this.autoExpand(o.children[2])),["expandObject"].includes(Object.keys(i.expandEvent._events)[0])&&["all","object"].includes(t)&&(i.expandEvent.emit("expandObject"),this.autoExpand(o.children[2])))}}},{key:"drawExpandButton",value:function(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"all",a=document.createElement("button");a.innerText=e,a.classList.add("expand-button"),a.addEventListener("click",function(){t.autoExpand(t.container,n)}),this.container.appendChild(a)}}],[{key:"new",value:function(){log("new GuaLog");for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return _construct(this,t)}}]),t}(),instanceGuaLog=GuaLog.new(),fepLog=function(){for(var e=0;e<arguments.length;e++)instanceGuaLog.logValue(e<0||arguments.length<=e?void 0:arguments[e])};module.exports={fepLog:fepLog};